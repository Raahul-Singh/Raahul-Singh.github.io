<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book - Raahul Singh</title>
    <meta name="description" content="A book review by Raahul Singh.">
    <link rel="stylesheet" href="css/style.css">
    <link rel="icon" href="assets/favicon.ico" type="image/x-icon">
    
    <!-- Theme script early load to prevent flashing -->
    <script src="js/theme.js"></script>
    
    <!-- Components script for common elements -->
    <script src="js/components.js"></script>
    
    <!-- Central navigation handler - must be after components.js -->
    <script src="js/navigation.js"></script>
    
    <!-- Content JSON checker - must load before content scripts -->
    <script src="js/init-content.js"></script>
    
    <!-- Social links module for rendering social icons -->
    <script src="js/social-links.js"></script>
    
    <!-- MathJax for LaTeX support -->
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
            }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <!-- Markdown parser script - our custom implementation -->
    <script src="js/markdown-parser.js"></script>
</head>
<body>
    <!-- Header will be inserted by components.js -->
    <header></header>

    <main>
        <article class="book-content">
            <header id="book-header">
                <h1 id="book-title"></h1>
                <div class="book-meta">
                    <span id="book-author"></span>
                    <time id="book-date"></time>
                </div>
                <div id="book-rating" class="book-rating"></div>
                <div id="book-tags" class="tags"></div>
            </header>

            <div id="book-content">
                <p>Loading book...</p>
            </div>
        </article>
    </main>

    <!-- Footer will be inserted by components.js -->
    <footer></footer>

    <script src="js/main.js" defer></script>
    
    <script>
        // Get book ID and call the parser function
        document.addEventListener('DOMContentLoaded', function() {
            // Try to get the book ID from localStorage
            const bookId = localStorage.getItem('selectedBook');
            const containerId = 'book-content'; // ID of the div to load content into
            
            console.log('Retrieved bookId from localStorage:', bookId);
            
            if (bookId) {
                const markdownPath = 'books/' + bookId + '.md';
                console.log('Constructed markdownPath:', markdownPath);
                
                // Call the function defined in markdown-parser.js
                loadAndRenderMarkdown({ containerId, markdownPath });
            } else {
                console.warn('No bookId found in localStorage.');
                // Handle case where no book ID is provided
                document.getElementById(containerId).innerHTML = 
                    '<p class="error">No book specified. Please select a book from the <a href="books.html">books page</a>.</p>';
            }
        });
    </script>
</body>
</html> 